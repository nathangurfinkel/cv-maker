version: 1
backend:
  phases:
    build:
      commands:
        - echo "Backend build started on `date`"
        - echo "Installing Python dependencies..."
        - pip install -r cv-app-ng-backend/requirements.txt
        - echo "Backend build completed on `date`"
frontend:
  phases:
    preBuild:
      commands:
        - echo "Frontend preBuild started on `date`"
        - cd cv-app-ng-frontend
        - npm ci
    build:
      commands:
        - echo "Frontend build started on `date`"
        - echo "Setting environment variables for production build"
        - export VITE_ENVIRONMENT=production
        - npm run build
        - echo "Frontend build completed on `date`"
  artifacts:
    baseDirectory: cv-app-ng-frontend/dist
    files:
      - '**/*'
  cache:
    paths:
      - cv-app-ng-frontend/node_modules/**/*
      - cv-app-ng-frontend/.npm/**/*
